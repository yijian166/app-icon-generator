function init(){radiusShow.src=radiusShowOriginURL,radiusShow.onload=function(){showRoundRectImg()}}function changeRadius(){"radiusRange"===this.id?radiusNum.value=this.value/100:radiusRange.value=100*this.value,showRoundRectImg(radiusRange.value),""!==appIconURL&&mackAndroidIcon(appIconURL)}function showRoundRectImg(e){var e=e?e:radiusRange.value,t=radiusShowOriginURL,n=getRoundRectImgDataURL(1e3,e,t);radiusShow.src=n}function handleDragEnter(){this.setAttribute("style","border-style:dashed;")}function handleDragLeave(){this.setAttribute("style","")}function handleDragOver(e){e.stopPropagation(),e.preventDefault()}function handleFileSelect(e){function t(e){return"image/png"==e?!0:!1}e.stopPropagation(),e.preventDefault();for(var n,a=e.dataTransfer.files,r=0;n=a[r];r++){var o=n.type?n.type:"n/a",d=new FileReader,i=t(o);i&&(d.onload=function(){return function(e){var t='<img src="'+e.target.result+'">';dragBox.innerHTML=t,appIconURL=e.target.result,mackIosIcon(appIconURL),mackAndroidIcon(appIconURL)}}(n),d.onerror=function(e){console.log(e.target.error.code)},d.readAsDataURL(n))}}function mackIosIcon(e){function t(e,t){var n=new Image;n.src=t;var a=document.createElement("canvas"),r=a.getContext("2d");return a.width=e,a.height=e,r.drawImage(n,0,0,e,e),a.toDataURL()}for(var n=[29,58,87,80,57,114,120,180,512,1024],a="",r=0,o=n.length;o>r;r++){var d=t(n[r],e);a+='<li><img src="'+d+'" >'+"</li>",icons.push({name:"iosICon"+n[r]+".png",imgData:d})}document.getElementById("iosIconList").innerHTML=a;var i=new Image;i.src=e}function mackAndroidIcon(e){function t(e,t){var n=new Image;n.src=t;var a=document.createElement("canvas"),r=a.getContext("2d");return a.width=e,a.height=e,r.drawImage(n,0,0,e,e),a.toDataURL()}for(var n=[48,72,96,144],a="",r=getRoundRectImgDataURL(1e3,radiusRange.value,e),o=0,d=n.length;d>o;o++){var i=t(n[o],r);a+='<li><img src="'+i+'" >'+"</li>",icons.push({name:"androidICon"+n[o]+".png",imgData:i})}document.getElementById("androidIconList").innerHTML=a}function getRoundRectImgDataURL(e,t,n){var a=new Image;a.src=n;var r=document.createElement("canvas");return r.getContext("2d"),r.width=e,r.height=e,function(e,t,n,a,r,o,d){var i=t+a,c=n+r,g=e.getContext("2d");return g.save(),g.beginPath(),g.moveTo(t+o,n),g.lineTo(i-o,n),g.quadraticCurveTo(i,n,i,n+o),g.lineTo(i,n+r-o),g.quadraticCurveTo(i,c,i-o,c),g.lineTo(t+o,c),g.quadraticCurveTo(t,c,t,c-o),g.lineTo(t,n+o),g.quadraticCurveTo(t,n,t+o,n),g.closePath(),g.clip(),g.drawImage(d,t,n,a,r),g.restore(),e.toDataURL()}(r,0,0,e,e,t,a)}function getBase64Data(e){return e.slice(22,-1)}function dataURItoBlob(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],a=new Uint8Array(t.length),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return new Blob([a],{type:n})}var appIconURL="",icons=[],dragBox=document.getElementById("dragBox"),siteUrl=window.location.href.slice(0,window.location.href.indexOf("/#"));dragBox.addEventListener("dragenter",handleDragEnter,!1),dragBox.addEventListener("dragover",handleDragOver,!1),dragBox.addEventListener("drop",handleFileSelect,!1),dragBox.addEventListener("dragleave",handleDragLeave,!1);var radiusRange=document.getElementById("radiusRange"),radiusNum=document.getElementById("radiusNum"),radiusShow=document.getElementById("radiusShow"),radiusShowOriginURL=siteUrl+radiusShow.getAttribute("data-src");radiusRange.addEventListener("change",changeRadius,!1),radiusNum.addEventListener("change",changeRadius,!1),init();var dl=document.getElementById("dl");dl.addEventListener("click",function(){for(var e=new JSZip,t=e.folder("ios"),n=e.folder("android"),a=0,r=icons.length;r>a;a++){var o=getBase64Data(icons[a].imgData),d=icons[a].name;d.match("ios")?t.file(icons[a].name,o,{base64:!0}):n.file(icons[a].name,o,{base64:!0})}var i=e.generate({type:"blob"});saveAs(i,"icons.zip")},!1);