function init(){radiusShow.src=radiusShowOriginURL,radiusShow.onload=function(){showRoundRectImg()}}function changeRadius(){"radiusRange"===this.id?radiusNum.value=this.value/100:radiusRange.value=100*this.value,showRoundRectImg(radiusRange.value),""!==appIconURL&&mackAndroidIcon(appIconURL)}function showRoundRectImg(e){var e=e?e:radiusRange.value,a=radiusShowOriginURL,n=getRoundRectImgDataURL(1e3,e,a);radiusShow.src=n}function handleDragEnter(){this.setAttribute("style","border-style:dashed;")}function handleDragLeave(){this.setAttribute("style","")}function handleDragOver(e){e.stopPropagation(),e.preventDefault()}function handleFileSelect(e){function a(e){return"image/png"==e?!0:!1}e.stopPropagation(),e.preventDefault();for(var n,t=e.dataTransfer.files,r=0;n=t[r];r++){var o=n.type?n.type:"n/a",i=new FileReader,d=a(o);d&&(i.onload=function(){return function(e){var a='<img src="'+e.target.result+'">';dragBox.innerHTML=a,appIconURL=e.target.result,dl.setAttribute("class","button-success pure-button"),mackIosIcon(appIconURL),mackAndroidIcon(appIconURL)}}(n),i.onerror=function(e){console.log(e.target.error.code)},i.readAsDataURL(n))}}function mackIosIcon(e){function a(e,a){var n=new Image;n.src=a;var t=document.createElement("canvas"),r=t.getContext("2d");return t.width=e,t.height=e,r.drawImage(n,0,0,e,e),t.toDataURL()}for(var n=[29,58,87,80,57,114,120,180,512,1024],t="",r=0,o=n.length;o>r;r++){var i=a(n[r],e);t+='<li><img src="'+i+'" >'+"<p>"+n[r]+"x"+n[r]+".png"+"</p>"+"</li>",icons.push({name:"iosICon"+n[r]+".png",imgData:i})}document.getElementById("iosIconList").innerHTML=t;var d=new Image;d.src=e}function mackAndroidIcon(e){function a(e,a){var n=new Image;n.src=a;var t=document.createElement("canvas"),r=t.getContext("2d");return t.width=e,t.height=e,r.drawImage(n,0,0,e,e),t.toDataURL()}for(var n=[48,72,96,144],t="",r=getRoundRectImgDataURL(1e3,radiusRange.value,e),o=0,i=n.length;i>o;o++){var d=a(n[o],r);t+='<li><img src="'+d+'" >'+"<p>"+n[o]+"x"+n[o]+".png"+"</p>"+"</li>",icons.push({name:"androidICon"+n[o]+".png",imgData:d})}document.getElementById("androidIconList").innerHTML=t}function getRoundRectImgDataURL(e,a,n){var t=new Image;t.src=n;var r=document.createElement("canvas");return r.getContext("2d"),r.width=e,r.height=e,function(e,a,n,t,r,o,i){var d=a+t,s=n+r,c=e.getContext("2d");return c.save(),c.beginPath(),c.moveTo(a+o,n),c.lineTo(d-o,n),c.quadraticCurveTo(d,n,d,n+o),c.lineTo(d,n+r-o),c.quadraticCurveTo(d,s,d-o,s),c.lineTo(a+o,s),c.quadraticCurveTo(a,s,a,s-o),c.lineTo(a,n+o),c.quadraticCurveTo(a,n,a+o,n),c.closePath(),c.clip(),c.drawImage(i,a,n,t,r),c.restore(),e.toDataURL()}(r,0,0,e,e,a,t)}function getBase64Data(e){return e.slice(22,-1)}function dataURItoBlob(e){var a;a=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],t=new Uint8Array(a.length),r=0;r<a.length;r++)t[r]=a.charCodeAt(r);return new Blob([t],{type:n})}var appIconURL="",icons=[],dragBox=document.getElementById("dragBox"),siteUrl=window.location.href.slice(0,window.location.href.indexOf("/#")),dl=document.getElementById("dl");dragBox.addEventListener("dragenter",handleDragEnter,!1),dragBox.addEventListener("dragover",handleDragOver,!1),dragBox.addEventListener("drop",handleFileSelect,!1),dragBox.addEventListener("dragleave",handleDragLeave,!1);var radiusRange=document.getElementById("radiusRange"),radiusNum=document.getElementById("radiusNum"),radiusShow=document.getElementById("radiusShow"),radiusShowOriginURL=siteUrl+radiusShow.getAttribute("data-src");radiusRange.addEventListener("change",changeRadius,!1),radiusNum.addEventListener("change",changeRadius,!1),init(),dl.addEventListener("click",function(){for(var e=new JSZip,a=e.folder("ios"),n=e.folder("android"),t=0,r=icons.length;r>t;t++){var o=getBase64Data(icons[t].imgData),i=icons[t].name;i.match("ios")?a.file(icons[t].name,o,{base64:!0}):n.file(icons[t].name,o,{base64:!0})}var d=e.generate({type:"blob"});saveAs(d,"icons.zip")},!1);